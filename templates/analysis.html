{% extends 'base.html' %}

{% load static %}
{% block title %}
Analysis
{% endblock %}

{% block styles %}
{% endblock %}

{% block content %}
<script src="{% static 'assets/js/jquery-3.4.1.js' %}"></script>
<form method="post" class="bg-white rounded pb_form_v1" id="analyzeform">
    {% csrf_token %}
    <h2 class="mb-4 mt-0 text-center">Analyze Tweets</h2>
    <div class="form-group">
        <input type="text" class="form-control pb_height-50 reverse" id="id_handle" name="handle"
            placeholder="Twitter Handle" value="{{ user }}" required>
    </div>
    <p class="mb-4 mt-0 text-center">{{ report }}</p>
    <strong>Duration</strong>
    <div class="container">
        <div class='col-md-9'>
            <div class="form-group">
                <div class="input-group date" id="datetimepicker7" data-target-input="nearest">
                    <input type="text" class="form-control datetimepicker-input" data-target="#datetimepicker7"
                        name="start" placeholder="Start Date" value="{{ start }}" required />
                    <div class="input-group-append" data-target="#datetimepicker7" data-toggle="datetimepicker">
                        <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                    </div>
                </div>
            </div>
        </div>
        <div class='col-md-9'>
            <div class="form-group">
                <div class="input-group date" id="datetimepicker8" data-target-input="nearest">
                    <input type="text" class="form-control datetimepicker-input" data-target="#datetimepicker8"
                        name="end" placeholder="End Date" value="{{ end }}" required />
                    <div class="input-group-append" data-target="#datetimepicker8" data-toggle="datetimepicker">
                        <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#datetimepicker7').datetimepicker({
                useCurrent: false,
                format: 'DD-MM-YYYY',
                locale: 'ru',
                minDate: (Date.now() - 7 * 24 * 3600 * 1000),
                maxDate: Date.now()
            });
            $('#datetimepicker8').datetimepicker({
                useCurrent: false,
                format: 'DD-MM-YYYY',
                locale: 'ru',
                minDate: (Date.now() - 6 * 24 * 3600 * 1000),
                maxDate: (Date.now() + 24 * 3600 * 1000),
            });
            $("#datetimepicker7").on("change.datetimepicker", function (e) {
                $('#datetimepicker8').datetimepicker('minDate', e.date);
            });
            $("#datetimepicker8").on("change.datetimepicker", function (e) {
                $('#datetimepicker7').datetimepicker('maxDate', e.date);
            });
        });
    </script>
    {% if graphs == False %}
    <div class="form-group">
        <input type="submit" id="analyzebutton" name="analyze"
            class="btn btn-primary btn-lg btn-block pb_btn-pill  btn-shadow-blue" value="Analyze">
        <input disabled type="submit" id="analyzebutton2"
            class="btn btn-primary btn-lg btn-block pb_btn-pill btn-shadow-blue" style="display: none"
            value="Please wait.....">
        <script type="text/javascript">
            $(document).ready(function () {
                $("#analyzeform").submit(function (e) {

                    //stop submitting the form to see the disabled button effect
                    //e.preventDefault();

                    $("#analyzebutton").hide();
                    $("#analyzebutton2").show();
                    return true;

                });
            });
        </script>
    </div>
    {% endif %}
</form>
{% endblock content %}

{% block rep %}
{% if graphs == True %}
<section class="pb_section bg-light pb_slant-white pb_pb-250" id="section-features">
    <div class="container">
        <div class="row mb-10">
            <img src="{{ path }}" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
            <img src="{{ path }}" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
            <img src="{{ path }}" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
            <img src="{{ path }}" style="float: left; width: 30%; margin-right: 1%; margin-bottom: 0.5em;">
        </div>
    </div>
    <div class="container">
        <div class="mb-4" style="margin-top: 50px;">
            <form method="post" class="bg-white rounded pb_form_v1" id="feedbackform">
                {% csrf_token %}
                <div class="form-group">
                    <label for="id_message">Message</label>
                    <textarea class="form-control" id="id_message" name="message" placeholder="Feedback" rows="5"
                        required></textarea>
                </div>
                <input type="submit" name="feedback" id="feedbackbutton"
                    class="btn btn-primary btn-lg btn-block pb_btn-pill  btn-shadow-blue" value="Feedback">
                <input disabled type="submit" id="feedbackbutton2"
                    class="btn btn-primary btn-lg btn-block pb_btn-pill btn-shadow-blue" style="display: none"
                    value="Please wait.....">
                <script type="text/javascript">
                    $(document).ready(function () {
                        $("#feedbackform").submit(function (e) {

                            //stop submitting the form to see the disabled button effect
                            //e.preventDefault();

                            $("#feedbackbutton").hide();
                            $("#feedbackbutton2").show();
                            return true;

                        });
                    });
                </script>
            </form>
        </div>
    </div>
</section>
{% endif %}
{% endblock rep %}